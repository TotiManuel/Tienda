{% extends "base.html" %}

{% block title %}MÃ³dulos de la Empresa{% endblock %}

{% block content %}

<h2>GestiÃ³n de MÃ³dulos</h2>

<table border="1" cellpadding="10" cellspacing="0">
    <thead>
        <tr>
            <th>Nombre</th>
            <th>CategorÃ­a</th>
            <th>Premium</th>
            <th>Estado</th>
            <th>AcciÃ³n</th>
        </tr>
    </thead>
    <tbody>
        {% for modulo in modulos %}

            {% set activo = false %}
            {% for em in empresa_modulos %}
                {% if em.modulo_id == modulo.id %}
                    {% set activo = em.activo %}
                {% endif %}
            {% endfor %}

            <tr>
                <td>
                    {{ modulo.icono }} {{ modulo.nombre }}
                </td>

                <td>{{ modulo.categoria }}</td>

                <td>
                    {% if modulo.es_premium %}
                        ðŸ”’ SÃ­
                    {% else %}
                        âœ” No
                    {% endif %}
                </td>

                <td>
                    {% if activo %}
                        <span style="color: green; font-weight: bold;">
                            Activo
                        </span>
                    {% else %}
                        <span style="color: red;">
                            Inactivo
                        </span>
                    {% endif %}
                </td>

                <td>
                    <a href="{{ url_for('toggle_modulo',
                        empresa_id=request.view_args.empresa_id,
                        modulo_id=modulo.id) }}">

                        {% if activo %}
                            Desactivar
                        {% else %}
                            Activar
                        {% endif %}

                    </a>
                </td>

            </tr>
        {% endfor %}
    </tbody>
</table>


<h2>Administrar mÃ³dulos</h2>

<div class="modules">

{% for modulo in modulos %}

    {% set activo = false %}

    {% for em in empresa_modulos %}
        {% if em.modulo_id == modulo.id and em.activo %}
            {% set activo = true %}
        {% endif %}
    {% endfor %}

    <div class="card">
        <h3>{{ modulo.icono }} {{ modulo.nombre }}</h3>
        <p>{{ modulo.descripcion }}</p>

        {% if activo %}
            <a class="btn btn-primary"
               href="{{ url_for('toggle_modulo', empresa_id=empresa_id, modulo_id=modulo.id) }}">
                Desactivar
            </a>
        {% else %}
            <a class="btn"
               href="{{ url_for('toggle_modulo', empresa_id=empresa_id, modulo_id=modulo.id) }}">
                Activar
            </a>
        {% endif %}
    </div>

{% endfor %}

</div>

{% endblock %}